import{u as S,r as h,h as M,c as _,a as t,d as N,e as P,f as a,b as i,w as R,v as V,n as m,F as z,i as A,t as w,o as p,R as E}from"./index-DnKSRMn7.js";import{a as r,S as F}from"./sweetalert2.all-DNnFSqmk.js";const I={id:"todoListPage",class:"bg-half"},K=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),U={class:"todo_sm"},j=t("span",null,"王小明的代辦",-1),q={class:"container todoListPage vhContainer"},G={class:"todoList_Content"},H={class:"inputBox"},J=t("i",{class:"fa fa-plus"},null,-1),Q=[J],W={class:"todoList_list"},X={class:"todoList_tab"},Y={class:"todoList_items"},Z={key:0,class:"todoList_item"},tt={class:"todoList_label"},et=["checked","onClick"],st=["onClick"],ot=t("i",{class:"fa fa-times"},null,-1),at=[ot],nt={key:1,class:"todoList_empty"},lt={class:"todoList_statistics"},u="https://todolist-api.hexschool.io",ut={__name:"TodoListView",setup(ct){const f=S(),y=({type:s,text:e})=>{F.fire({title:"訊息",text:e,icon:s,confirmButtonText:"關閉"})},T=$(),d={headers:{Authorization:T}};function $(){return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)todoListToken\\s*=\\s*([^;]*).*$)|^.*$"),"$1")}const x=async()=>{try{await r.get(`${u}/users/checkout`,d)}catch{y({type:"error",text:"登入驗證失效"}),f.push("/")}},C=async()=>{try{const s=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:T}});y({type:"success",text:s.data.message}),f.push("/")}catch{y({type:"error",text:"登出失敗"}),f.push("/")}},L=h(""),D=async()=>{try{const s=await r.post(`${u}/todos/`,{content:L.value},d);console.log(s),k()}catch(s){console.log(s)}};let n=h([]),l=h(""),v=h(0),c=h([]);async function k(s="all"){try{const e=await r.get(`${u}/todos/`,d);n.value=[...e.data.data],g(s),console.log(e)}catch(e){console.log(e)}}const b=async s=>{try{const e=await r.patch(`${u}/todos/${s}/toggle`,{},d);console.log(e),k()}catch(e){console.log(e)}},B=async s=>{try{const e=await r.delete(`${u}/todos/${s}`,d);console.log(e),k()}catch(e){console.log(e)}},g=s=>{switch(l.value=s,l.value){case"checked":c.value=n.value.filter(e=>e.status),v.value=c.value.length;break;case"unchecked":c.value=n.value.filter(e=>!e.status),v.value=c.value.length;break;case"all":default:c.value=[...n.value],v.value=n.value.filter(e=>!e.status).length;break}};return M(()=>{x(),k()}),(s,e)=>(p(),_("div",I,[t("nav",null,[K,t("ul",null,[t("li",U,[N(a(E),{to:"/todoList",class:"formControls_btnLink"},{default:P(()=>[j]),_:1})]),t("li",null,[t("a",{href:"#loginPage",onClick:i(C,["prevent"])},"登出")])])]),t("div",q,[t("div",G,[t("div",H,[R(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=o=>L.value=o)},null,512),[[V,L.value]]),t("a",{href:"#",onClick:i(D,["prevent"])},Q)]),t("div",W,[t("ul",X,[t("li",null,[t("a",{href:"#",class:m(a(l)==="all"?"active":""),onClick:e[1]||(e[1]=i(o=>g("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:m(a(l)==="unchecked"?"active":""),onClick:e[2]||(e[2]=i(o=>g("unchecked"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:m(a(l)==="checked"?"active":""),onClick:e[3]||(e[3]=i(o=>g("checked"),["prevent"]))},"已完成",2)])]),t("div",Y,[a(n).length?(p(),_("ul",Z,[(p(!0),_(z,null,A(a(c),o=>(p(),_("li",{key:o.id},[t("label",tt,[t("input",{class:"todoList_input",type:"checkbox",checked:o.status,onClick:O=>b(o.id)},null,8,et),t("span",null,w(o.content),1)]),t("a",{href:"#",onClick:i(O=>B(o.id),["prevent"])},at,8,st)]))),128))])):(p(),_("p",nt,"目前尚無待辦事項")),t("div",lt,[t("p",null,w(a(v))+" 個"+w(a(l)==="checked"?"已":"待")+"完成項目",1)])])])])])]))}};export{ut as default};
