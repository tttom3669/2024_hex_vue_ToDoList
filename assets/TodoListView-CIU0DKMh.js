import{u as S,r as h,h as M,c as _,a as t,d as N,e as P,f as a,b as c,w as R,v as V,n as m,F as z,i as A,t as w,o as p,R as E}from"./index-B4FVNmXT.js";import{a as r,S as F}from"./sweetalert2.all-DNnFSqmk.js";const I={id:"todoListPage",class:"bg-half"},K=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),U={class:"todo_sm"},j=t("span",null,"王小明的代辦",-1),q={class:"container todoListPage vhContainer"},G={class:"todoList_Content"},H={class:"inputBox"},J=t("i",{class:"fa fa-plus"},null,-1),Q=[J],W={class:"todoList_list"},X={class:"todoList_tab"},Y={class:"todoList_items"},Z={key:0,class:"todoList_item"},tt={class:"todoList_label"},et=["checked","onClick"],st=["onClick"],ot=t("i",{class:"fa fa-times"},null,-1),at=[ot],lt={key:1,class:"todoList_empty"},nt={class:"todoList_statistics"},u="https://todolist-api.hexschool.io",ut={__name:"TodoListView",setup(it){const g=S(),T=$(),d={headers:{Authorization:T}},y=h("");let l=h([]),n=h(""),v=h(0),i=h([]);function L({type:s,text:e}){F.fire({title:"訊息",text:e,icon:s,confirmButtonText:"關閉"})}function $(){return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)todoListToken\\s*=\\s*([^;]*).*$)|^.*$"),"$1")}const x=async()=>{try{await r.get(`${u}/users/checkout`,d)}catch{L({type:"error",text:"登入驗證失效"}),g.push("/")}},C=async()=>{try{const s=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:T}});L({type:"success",text:s.data.message}),g.push("/")}catch{L({type:"error",text:"登出失敗"}),g.push("/")}},D=async()=>{try{await r.post(`${u}/todos/`,{content:y.value},d),k()}catch(s){console.log(s)}};async function k(s="all"){try{const e=await r.get(`${u}/todos/`,d);l.value=[...e.data.data],f(s)}catch(e){console.log(e)}}const b=async s=>{try{await r.patch(`${u}/todos/${s}/toggle`,{},d),k()}catch(e){console.log(e)}},B=async s=>{try{await r.delete(`${u}/todos/${s}`,d),k()}catch(e){console.log(e)}},f=s=>{switch(n.value=s,n.value){case"checked":i.value=l.value.filter(e=>e.status),v.value=i.value.length;break;case"unchecked":i.value=l.value.filter(e=>!e.status),v.value=i.value.length;break;case"all":default:i.value=[...l.value],v.value=l.value.filter(e=>!e.status).length;break}};return M(()=>{x(),k()}),(s,e)=>(p(),_("div",I,[t("nav",null,[K,t("ul",null,[t("li",U,[N(a(E),{to:"/todoList",class:"formControls_btnLink"},{default:P(()=>[j]),_:1})]),t("li",null,[t("a",{href:"#loginPage",onClick:c(C,["prevent"])},"登出")])])]),t("div",q,[t("div",G,[t("div",H,[R(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=o=>y.value=o)},null,512),[[V,y.value]]),t("a",{href:"#",onClick:c(D,["prevent"])},Q)]),t("div",W,[t("ul",X,[t("li",null,[t("a",{href:"#",class:m(a(n)==="all"?"active":""),onClick:e[1]||(e[1]=c(o=>f("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:m(a(n)==="unchecked"?"active":""),onClick:e[2]||(e[2]=c(o=>f("unchecked"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:m(a(n)==="checked"?"active":""),onClick:e[3]||(e[3]=c(o=>f("checked"),["prevent"]))},"已完成",2)])]),t("div",Y,[a(l).length?(p(),_("ul",Z,[(p(!0),_(z,null,A(a(i),o=>(p(),_("li",{key:o.id},[t("label",tt,[t("input",{class:"todoList_input",type:"checkbox",checked:o.status,onClick:O=>b(o.id)},null,8,et),t("span",null,w(o.content),1)]),t("a",{href:"#",onClick:c(O=>B(o.id),["prevent"])},at,8,st)]))),128))])):(p(),_("p",lt,"目前尚無待辦事項")),t("div",nt,[t("p",null,w(a(v))+" 個"+w(a(n)==="checked"?"已":"待")+"完成項目",1)])])])])])]))}};export{ut as default};
