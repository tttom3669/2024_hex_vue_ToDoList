import{u as O,r as c,h as S,c as h,a as t,d as M,e as P,f as R,b as i,w as V,v as z,n as L,F as A,i as E,t as g,o as v,R as F}from"./index-B666wUBn.js";import{a as r,S as I}from"./sweetalert2.all-DNnFSqmk.js";const K={id:"todoListPage",class:"bg-half"},U=t("h1",null,[t("a",{href:"#"},"ONLINE TODO LIST")],-1),j={class:"todo_sm"},q={class:"container todoListPage vhContainer"},G={class:"todoList_Content"},H={class:"inputBox"},J=t("i",{class:"fa fa-plus"},null,-1),Q=[J],W={class:"todoList_list"},X={class:"todoList_tab"},Y={class:"todoList_items"},Z={key:0,class:"todoList_item"},tt={class:"todoList_label"},et=["checked","onClick"],st=["onClick"],ot=t("i",{class:"fa fa-times"},null,-1),at=[ot],lt={key:1,class:"todoList_empty"},nt={class:"todoList_statistics"},u="https://todolist-api.hexschool.io",ut={__name:"TodoListView",setup(ct){const y=O(),w=$(),d={headers:{Authorization:w}},T=c(""),_=c(""),l=c([]),o=c("all"),p=c(0),n=c([]);function m({type:s,text:e}){I.fire({title:"訊息",text:e,icon:s,confirmButtonText:"關閉"})}function $(){return document.cookie.replace(new RegExp("(?:(?:^|.*;\\s*)todoListToken\\s*=\\s*([^;]*).*$)|^.*$"),"$1")}const x=async()=>{try{const s=await r.get(`${u}/users/checkout`,d);T.value=s.data.nickname}catch{m({type:"error",text:"登入驗證失效"}),y.push("/")}},C=async()=>{try{const s=await r.post(`${u}/users/sign_out`,{},{headers:{Authorization:w}});m({type:"success",text:s.data.message}),y.push("/")}catch{m({type:"error",text:"登出失敗"}),y.push("/")}},D=async()=>{try{await r.post(`${u}/todos/`,{content:_.value},d),_.value="",k(o)}catch(s){console.log(s)}};async function k(s="all"){try{const e=await r.get(`${u}/todos/`,d);l.value=[...e.data.data],f(s)}catch(e){console.log(e)}}const b=async s=>{try{await r.patch(`${u}/todos/${s}/toggle`,{},d),k(o)}catch(e){console.log(e)}},B=async s=>{try{await r.delete(`${u}/todos/${s}`,d),k(o)}catch(e){console.log(e)}},f=s=>{switch(o.value=s,o.value){case"checked":n.value=l.value.filter(e=>e.status),p.value=n.value.length;break;case"unchecked":n.value=l.value.filter(e=>!e.status),p.value=n.value.length;break;case"all":default:n.value=[...l.value],p.value=l.value.filter(e=>!e.status).length;break}};return S(()=>{x(),k(o)}),(s,e)=>(v(),h("div",K,[t("nav",null,[U,t("ul",null,[t("li",j,[M(R(F),{to:"/todoList",class:"formControls_btnLink"},{default:P(()=>[t("span",null,g(T.value)+"的代辦",1)]),_:1})]),t("li",null,[t("a",{href:"#loginPage",onClick:i(C,["prevent"])},"登出")])])]),t("div",q,[t("div",G,[t("div",H,[V(t("input",{type:"text",placeholder:"請輸入待辦事項","onUpdate:modelValue":e[0]||(e[0]=a=>_.value=a)},null,512),[[z,_.value]]),t("a",{href:"#",onClick:i(D,["prevent"])},Q)]),t("div",W,[t("ul",X,[t("li",null,[t("a",{href:"#",class:L(o.value==="all"?"active":""),onClick:e[1]||(e[1]=i(a=>f("all"),["prevent"]))},"全部",2)]),t("li",null,[t("a",{href:"#",class:L(o.value==="unchecked"?"active":""),onClick:e[2]||(e[2]=i(a=>f("unchecked"),["prevent"]))},"待完成",2)]),t("li",null,[t("a",{href:"#",class:L(o.value==="checked"?"active":""),onClick:e[3]||(e[3]=i(a=>f("checked"),["prevent"]))},"已完成",2)])]),t("div",Y,[l.value.length?(v(),h("ul",Z,[(v(!0),h(A,null,E(n.value,a=>(v(),h("li",{key:a.id},[t("label",tt,[t("input",{class:"todoList_input",type:"checkbox",checked:a.status,onClick:N=>b(a.id)},null,8,et),t("span",null,g(a.content),1)]),t("a",{href:"#",onClick:i(N=>B(a.id),["prevent"])},at,8,st)]))),128))])):(v(),h("p",lt,"目前尚無待辦事項")),t("div",nt,[t("p",null,g(p.value)+" 個"+g(o.value==="checked"?"已":"待")+"完成項目",1)])])])])])]))}};export{ut as default};
